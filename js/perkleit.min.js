$(document).ready(function(){var g=1;var f=2;var d=2;var e=3;var h,b,a,c;a=function(k){if(k.width&&k.height){$("#pl").html('<table id="plMap" class="map"><tbody></tbody></table>');
for(var l=0;l<k.height;l++){$("#plMap > tbody:last").append("<tr></tr>");for(var m=0;
m<k.width;m++){$("#plMap > tbody > tr:last").append('<td id="plTile_'+m+"_"+l+'" class="unknown"> </td>');
}}revealTiles(k.visible);c={hash:k.hash,x:k.x,y:k.y,moves:k.moves};b=function(i,j){$.ajax({url:"/move.php",type:"post",data:{h:c.hash,x:i,y:j},dataType:"json",success:function(n){if(n.success){$("#plTile_"+c.x+"_"+c.y).removeClass("player");
c.x=i;c.y=j;$("#plTile_"+c.x+"_"+c.y).addClass("player");revealTiles(n.reveal);c.moves=n.moves;
$("#plCounterNumber").html(c.moves);if(n.status===e){alert("Congratulations! You have reached the finish!");
}}else{if(n.status===d){alert("Game Over. You ran out of moves.");}}}});};$(document).bind("keydown.right",function(){b(c.x+1,c.y);
});$(document).bind("keydown.left",function(){b(c.x-1,c.y);});$(document).bind("keydown.down",function(){b(c.x,c.y+1);
});$(document).bind("keydown.up",function(){b(c.x,c.y-1);});$("#plTile_"+c.x+"_"+c.y).addClass("player");
$("#pl").append('<div id="plCounter"><span id="plCounterNumber">'+c.moves+"</span> moves remaining</div>");
}};revealTiles=function(k){for(var j in k){tile=k[j];if(tile.open){cssClass="open";
}else{cssClass="closed";}if(tile.special===g){cssClass="start";}else{if(tile.special===f){cssClass="finish";
}}$("#plTile_"+tile.x+"_"+tile.y).attr("class",cssClass);}};h=function(){var i=new Image();
i.src="/img/loading4.gif";$("#pl").html(i).append(" loading");$.ajax({url:"/start.php",dataType:"json",success:a});
};h();});